apiVersion: kpt.dev/v1
kind: Kptfile
metadata:
  name: bmh
  annotations:
    config.kubernetes.io/local-config: "true"
info:
  description: BMH Kpt Package
pipeline:
  mutators:
  - name: Set bootMACAddress
    image: gcr.io/kpt-fn/search-replace:v0.2.0
    configMap:
      by-path: spec.bootMACAddress
      put-value: F8:BC:12:51:C4:C0
    selectors:
    - kind: BareMetalHost
  - name: Set bmc.address
    image: gcr.io/kpt-fn/search-replace:v0.2.0
    configMap:
      by-path: spec.bmc.address
      put-value: redfish+https://192.168.0.120/redfish/v1/Systems/System.Embedded.1
    selectors:
    - kind: BareMetalHost
  - name: Set bmc.credentialsName
    image: gcr.io/kpt-fn/search-replace:v0.2.0
    configMap:
      by-path: spec.bmc.credentialsName
      put-value: server01-bmc-secret
    selectors:
    - kind: BareMetalHost